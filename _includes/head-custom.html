{% if jekyll.environment == "production" %}
    <!-- Analytics -->
    <script data-host="https://microanalytics.io" data-dnt="false" src="https://microanalytics.io/js/script.js" id="ZwSg9rf6GA" async defer></script>
{% endif %}

{% if page.style %}
    <!-- Custom Style -->
    <link rel="stylesheet" href="{{ page.style | append: '.css' | relative_url }}">
{% endif %}

{% if page.mermaid %}
    <!-- Mermaid -->
    <script defer src="https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded',()=>{
            mermaid.initialize({ startOnLoad: true })
        })
    </script>
{% endif %}

{% if page.math %}
    <!-- KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha256-TThEtR+XalhWKkfF383YLOrI50NGNeIqrzS+q08afrY=" crossorigin="anonymous">
    <script type="module">
        import renderMathInElement from "https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.mjs"

        renderMathInElement(document.body, {
            delimiters: [
                { left: '\\(', right: '\\)', display: false },
                { left: '\\[', right: '\\]', display: true },
                { left: '$$', right: '$$', display: true },
                { left: '$', right: '$', display: false },
            ],
            macros: {
                // Jekyll's "smart quotes" feature
                // → https://katex.org/docs/issues.html
                "’": "'",
                "\\abs": String.raw`{\left\lvert #1 \right\rvert}`,
                "\\dd": String.raw`\mathop{}\!\mathrm{d}`,
            },
        })
    </script>
{% endif %}
